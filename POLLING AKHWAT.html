<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>POLLING AKHWAT </title>
  <style>
    :root{
      --bg:#0b0f0a;
      --chalk:#f4f4f4;
      --green:#0f2414;
      --line:#ffffff22;
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;
      background:var(--bg);
      font-family:'Times New Roman', serif;
      display:flex;align-items:center;justify-content:center;padding:20px;
      color:var(--chalk);
    }
    @font-face{
      font-family:'Schoolbell';
      src:local('Schoolbell'), url('https://fonts.gstatic.com/s/schoolbell/v14/92zQtBZWOrcgoe-fgnJIZxYl.woff2') format('woff2');
    }
    .wrap{width:100%;max-width:820px}

    .card{
      background:var(--green);
      border:3px solid #0a160d;
      padding:24px;border-radius:12px;
      box-shadow:0 0 50px #000 inset;
      color:var(--chalk);
    }

    h1{margin:0 0 6px;font-size:28px;color:var(--chalk);text-shadow:1px 2px #000}
    p.lead{margin:0 0 18px;font-size:15px;color:#ffffffaa}

    .option{padding:12px 10px;border-bottom:1px dashed var(--line)}
    .option-row{display:flex;align-items:center;gap:14px;font-size:20px}

    .opt-btn{
      font-family:inherit;
      padding:6px 10px;border:2px solid var(--chalk);
      background:transparent;color:var(--chalk);
      border-radius:6px;cursor:pointer;font-size:16px;
    }
    .opt-btn:hover{background:#ffffff22}

    .percent{margin-left:auto;font-weight:700;font-size:20px}

    .bar-wrap{height:10px;background:#ffffff22;border-radius:99px;margin-top:6px}
    .bar{height:100%;width:0%;background:var(--chalk);transition:width .6s}

    .controls{display:flex;gap:10px;margin-top:14px}
    input[type=text]{flex:1;padding:6px;border:2px solid #ffffff33;background:transparent;color:var(--chalk);border-radius:6px;font-family:inherit;font-size:16px}
    button.primary{background:var(--chalk);color:var(--green);border:none;padding:8px 14px;border-radius:6px;font-family:inherit;font-weight:700;cursor:pointer;font-size:16px}
    button.ghost{background:transparent;border:2px solid #ffffff33;color:var(--chalk);padding:6px 12px;border-radius:6px;cursor:pointer;font-size:16px}

    footer{margin-top:20px;font-size:14px;color:#ffffff88;text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">OSFOR</div>
      <div>
        <h1>PAPAN PEMILIHAN WAKETOS OSFOR AKHWAT 26/27</h1>
        <p class="lead">Made by OSFOR AKHWAT 25/26</p>
      </div>
    </header>

    <div class="card" id="pollCard">
      <div style="display:flex;gap:12px;align-items:center;justify-content:space-between;">
        <strong id="question">PERHITUNGAN SUARA WAKETOS 26/27</strong>
        <div style="font-size:13px;color:var(--muted);">Total suara: <span id="totalVotes">0</span></div>
      </div>

      <div class="options" id="options"></div>

      <div class="controls">
        <input id="newOptInput" type="text" placeholder="Tambah pilihan baru, contoh : shalder" />
        <button class="primary" id="addOpt">Tambah</button>
        <button class="ghost" id="resetBtn" title="Reset semua suara">Reset</button>
      </div>

      <footer>
        <div>Disimpan di browser menggunakan <strong>localStorage</strong>.</div>
         <p><i>Semua Hak Cipta Terlindungi 2025</p></i>
      </footer>
    </div>
  </div>

  <script>
    // Simple offline polling app. Data stored in localStorage under key 'chalk_poll_v1'.
    const STORAGE_KEY = 'chalk_poll_v1';

    // default options
    const DEFAULT = {
      question: 'PENGHITUNGAN SUARA WAKETOS 26/27',
      options: [
        {id:1,label:'Azel',votes:0,img:'azel.jpg'},
        {id:2,label:'Hanuna',votes:0,img:'hanuna.jpg'},
        {id:3,label:'Zia',votes:0,img:'zia.jpg'},
        {id:4,label:'Quinza',votes:0,img:'Quinza.jpg'}
      ]
    }

    function load() {
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return structuredClone(DEFAULT);
        return JSON.parse(raw);
      }catch(e){console.error('load fail',e);return structuredClone(DEFAULT)}
    }

    function save(state){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }

    let state = load();

    const optionsEl = document.getElementById('options');
    const totalVotesEl = document.getElementById('totalVotes');
    const questionEl = document.getElementById('question');

    questionEl.textContent = state.question;

    function totalVotes(){ return state.options.reduce((s,o)=>s+ (o.votes||0),0); }

    function render(){
      optionsEl.innerHTML = '';
      const total = totalVotes();
      totalVotesEl.textContent = total;

      state.options.sort((a,b)=>b.votes - a.votes).forEach(opt => {
        const optWrap = document.createElement('div');
        optWrap.className = 'option';

        const row = document.createElement('div');
        row.className = 'option-row';

        const btn = document.createElement('button');
        btn.className = 'opt-btn';
        btn.innerText = 'Pilih';
        btn.onclick = () => { vote(opt.id); animatePulse(btn); };

        // small title per candidate
        const small = document.createElement('div');
        small.style.fontSize = '14px';
        small.style.opacity = '0.8';
        small.innerText = 'Kandidat ' + opt.id;
        row.appendChild(small);

        const label = document.createElement('div');
        label.className = 'opt-label';
        label.innerText = opt.label;

        const percent = document.createElement('div');
        percent.className = 'percent';
        const pct = total === 0 ? 0 : Math.round((opt.votes/total)*100);
        percent.innerText = opt.votes + ' suara';

        row.appendChild(btn);
        // image
        const img = document.createElement('img');
        img.src = opt.img || 'https://via.placeholder.com/60?text=Foto';
        img.style.width='55px';
        img.style.height='55px';
        img.style.borderRadius='6px';
        img.style.objectFit='cover';
        row.appendChild(img);
        row.appendChild(label);
        row.appendChild(percent);

        const barWrap = document.createElement('div');
        barWrap.className = 'bar-wrap';
        const bar = document.createElement('div');
        bar.className = 'bar';
        // set width after a tiny delay for smooth transition
        requestAnimationFrame(()=>{ bar.style.width = pct + '%'; });
        barWrap.appendChild(bar);

        // small helper: remove option long-press (or click while holding shift)
        const removeBtn = document.createElement('button');
        removeBtn.className = 'ghost';
        removeBtn.style.marginLeft='8px';
        removeBtn.style.fontSize='12px';
        removeBtn.innerText='Hapus';
        removeBtn.title = 'Hapus pilihan ini';
        removeBtn.onclick = (e)=>{ e.stopPropagation(); if(confirm('Hapus pilihan "'+opt.label+'"?')){ removeOption(opt.id); } };

        optWrap.appendChild(row);
        optWrap.appendChild(barWrap);
        // show small remove button under bar for clarity
        const rmRow = document.createElement('div'); rmRow.style.display='flex'; rmRow.style.justifyContent='flex-end'; rmRow.style.marginTop='6px'; rmRow.appendChild(removeBtn);
        optWrap.appendChild(rmRow);

        optionsEl.appendChild(optWrap);
      });
    }

    function vote(id){
      const opt = state.options.find(o=>o.id===id);
      if(!opt) return;
      opt.votes = (opt.votes||0) + 1;
      save(state);
      render();
    }

    function addOption(label){
      if(!label || !label.trim()) return;
      const maxId = state.options.reduce((m,o)=>Math.max(m,o.id),0);
      state.options.push({id: maxId+1, label: label.trim(), votes:0});
      save(state); render();
    }

    function removeOption(id){
      state.options = state.options.filter(o=>o.id!==id);
      save(state); render();
    }

    function resetAll(){ if(!confirm('Reset semua suara dan kembalikan nilai default?')) return; localStorage.removeItem(STORAGE_KEY); state = load(); render(); }

    // small button pulse animation
    function animatePulse(el){ el.animate([{transform:'scale(1)'},{transform:'scale(0.96)'},{transform:'scale(1)'}],{duration:260}); }

    // wire controls
    document.getElementById('addOpt').onclick = ()=>{ const v = document.getElementById('newOptInput').value; addOption(v); document.getElementById('newOptInput').value=''; }
    document.getElementById('resetBtn').onclick = resetAll;

    // initial render
    render();

    // allow pressing Enter to add
    document.getElementById('newOptInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ document.getElementById('addOpt').click(); } });

    // expose helpers to console for quick debug
    window.pollState = ()=>state;
    window.pollReset = ()=>{ localStorage.removeItem(STORAGE_KEY); state=load(); render(); }
  </script>
</body>
</html>
